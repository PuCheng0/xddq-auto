# XDDQ Auto

现代化 GUI 脚本工具，用于自动完成“福地采集”等操作。基于 PySide6 + OpenCV + PyAutoGUI + Tesseract OCR。

## 功能特性
- 现代化拟态风格 GUI，窗口可调整大小
- 支持划定屏幕识别区域，提升识别精度与性能
- 资源多选与优先级：桃、玻璃珠、仙玉、净瓶水、天衍令（3/4/5级可勾选）
- 资源识别并点击，模板匹配并行加速
- 采集时间 OCR：
  - 点击两次“加号.png”后，采集前识别“采集时间.png”右侧时间
  - 如果识别成功，直接基于秒数等待；失败则自动轮询“采集完成.png”
- 前往路径遍历（六个“前往.png”从上到下），无目标则自动刷新并等待冷却
- 阈值与“近阈值放宽”可控，以平衡精准度与召回率
- 日志面板实时输出关键步骤与诊断信息

## 运行环境
- 操作系统：Windows 10/11（已针对 DPI 做兼容设置）
- Python：3.9+（建议使用 64 位）

### Python 依赖
```bash
pip install -r requirements.txt
```
如未提供 `requirements.txt`，可手动安装：
```bash
pip install PySide6 numpy opencv-python pyautogui pytesseract
```

### 安装 Tesseract OCR（Windows）
- 建议安装路径：`D:\\Program Files\\Tesseract-OCR\\tesseract.exe`
- 安装包可从官方项目或可信镜像下载（如 GitHub 或各大开源镜像站）
- 首次运行可在 GUI 顶部设置框中选择 `tesseract.exe`；应用会记住该路径

## 资源文件
- 将图片模板放在 `assets/` 目录（与 `app.py` 同级）
- 已用到的文件名示例：
  - 基础按钮：`target.png`、`洞府.png`、`福地.png`、`探寻.png`、`刷新.png`、`前往.png`、`关闭.png`、`加号.png`、`采集.png`、`采集完成.png`、`采集时间.png`
  - 资源模板：
    - 桃：`三级桃.png`、`四级桃.png`、`五级桃.png`
    - 玻璃珠：`三级玻璃珠.png`、`四级玻璃珠.png`、`五级玻璃珠.png`
    - 仙玉：`三级仙玉.png`、`四级仙玉.png`、`五级仙玉.png`
    - 净瓶水：`三级净瓶水.png`、`四级净瓶水.png`、`五级净瓶水.png`
    - 天衍令：`三级天衍令.png`、`四级天衍令.png`、`五级天衍令.png`

确保命名与大小清晰、背景干净，能显著提升模板匹配效果。

## 启动与使用
```bash
python app.py
```
界面布局：
- Tesseract 路径：顶部设置框，可浏览选择 `tesseract.exe`
- 控制：
  - 选择区域：弹出覆盖层，框选屏幕识别区域
  - 阈值：模板匹配阈值（默认 0.82）
  - 近阈值放宽：在阈值基础上最多放宽 0.06（最低 0.72），提升召回率
- 资源选择（可多选）：滚动区域内勾选 3/4/5 级资源
- 日志：显示过程信息与诊断
- 开始/停止：右下角操作按钮

采集流程概述：
1. 进入 `target.png` → `洞府.png` → `福地.png`
2. 按勾选优先级识别资源，点击进入
3. 点击两次 `加号.png`
4. 采集前 OCR 读取 `采集时间.png` 右侧时间；识别成功则按秒数等待，否则轮询 `采集完成.png`
5. 若当前页无目标资源：转入 `探寻.png` → 遍历六个 `前往.png` → 资源识别 → 采集；六个都没有则 `刷新.png` 并等待冷却

## 常见问题
- 无法识别/点击：
  - 检查是否正确选择屏幕区域（建议只框窗口主体）
  - 调整“阈值”和“近阈值放宽”
  - 确认 `assets/` 模板清晰、干净、与当前分辨率/DPI 接近
- OCR 失败：
  - 确认已正确设置 `tesseract.exe` 路径
  - 提高游戏内文本清晰度或亮度，对比度
- 高分屏/DPI：
  - 程序启用了 DPI 兼容设置；若识别不稳，可尝试统一缩放为 100%

## 目录结构示例
```
xddq-auto/
  app.py
  assets/
    采集.png
    采集完成.png
    采集时间.png
    前往.png
    ...
  README.md
  requirements.txt (可选)
```

## 免责声明
本工具仅用于学习与个人研究，请遵循相关应用/游戏的使用条款与法律法规。作者不对因使用本工具造成的任何后果承担责任。 